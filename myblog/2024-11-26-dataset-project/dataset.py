# -*- coding: utf-8 -*-
"""dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1W_DyEOwRIZv15PBRdi8kTsQTVaftjlrh
"""

# Commented out IPython magic to ensure Python compatibility.
import pandas as pd
import matplotlib.pyplot as plt
# Run this cell
import os
import numpy as np
import pandas as pd

import seaborn as sns
import plotly.express as px
import matplotlib.pyplot as plt
# %matplotlib inline




url = 'healthcare_dataset.csv'
df = pd.read_csv(url)

df.head(5)

billing_by_condition = df.groupby('Medical Condition')['Billing Amount'].sum().reset_index()
print(billing_by_condition)
ax = billing_by_condition.plot(x='Medical Condition', y='Billing Amount', kind='bar',
                               color='pink', title='Total Billing Amount per Medical Condition')
ax.set_xlabel('Medical Condition')
ax.set_ylabel('Total Billing Amount')
ax.set_xticklabels(ax.get_xticklabels(), rotation=45)

# Display the plot
plt.tight_layout()
plt.show()

# the graph shows that the most amount billed per medical condition was Hypertension so I decided to look more into it

df.columns

df.describe()

bill = df['Name'].count()
print(bill)

mostcost = df.groupby('Name')['Billing Amount'].sum().sort_values(ascending=False).head(5)
leastcost = df.groupby('Name')['Billing Amount'].sum().sort_values(ascending=True).head(5)
print(mostcost)
print(leastcost)

df.dtypes

from re import A
hypertension = df[df['Medical Condition'] == 'Hypertension']

print(aetna)
print(hypertension)
insurance = hypertension['Insurance Provider'].value_counts()
print(insurance)

# so it shows the number one insurance provider for people with hypertesion was United Healthercare

costly = df.groupby(hypertension['Insurance Provider'])['Billing Amount'].sum().sort_values(ascending=False).head(5)
print(costly)

# shows which insurance is the one that billed people the most which was Aetna

plt.bar(costly.index, costly.values)
plt.xlabel('Insurance Provider')
plt.ylabel('Total Billing Amount')
plt.title('Total Billing Amount by Insurance Provider')
plt.show()


medication = hypertension['Medication'].value_counts()
print(medication)

plt.bar(medication.index, medication.values)
plt.xlabel('Medication')
plt.ylabel('Frequency')
plt.title('Frequency of Medications')
plt.show()

costmed = df.groupby(hypertension['Medication'])['Billing Amount'].sum().sort_values(ascending=False).head(5)
print(costmed)

# iburprofen was billed the most

aetna = hypertension[hypertension['Insurance Provider'] == 'Aetna']
print(aetna)

aetnamed = aetna['Medication'].value_counts()
print(aetnamed)

plt.bar(aetnamed.index, aetnamed.values)
plt.xlabel('Medication')
plt.ylabel('Frequency')
plt.title('Frequency of Medications')
plt.show()

# so aetna provided paracetmol more often to people with hypertension while
#iburprofen was the most prescribed medication overall for others insurance providers
paracetemol = aetna[aetna['Medication'] == 'Paracetamol']
print(paracetemol)
aetnadoctors = paracetemol['Doctor'].value_counts()
print(aetnadoctors)

admissiontype = hypertension['Admission Type'].value_counts()
print(admissiontype)

plt.bar(admissiontype.index, admissiontype.values)
plt.xlabel('Admission Type')
plt.ylabel('Frequency')
plt.title('Frequency of Admission Types')
plt.show()

# most people with hypertension were being admitted under elective

med_admission = df.groupby('Medical Condition')['Admission Type'].value_counts()
print(med_admission)
plt.pie(med_admission, labels=med_admission.index, autopct='%1.1f%%')
plt.title('Admission Types by Medical Condition')
plt.show()

#Admission by Elective was the one that was the most billed
admissionavg = df.groupby('Admission Type')['Billing Amount'].mean()
print(admissionavg)
plt.pie(admissionavg, labels=admissionavg.index, autopct='%1.1f%%')
plt.title('Admission Types by Billing Amount')
plt.show()
# hypertension with an admission of elective was the most frequent this could be why
# it was billed the most
